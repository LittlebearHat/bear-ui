{"version":3,"file":"virtual.js","sources":["../../../virtual-list/src/virtual.tsx"],"sourcesContent":["import { createNamespace } from '@bear-ui/hooks'\nimport { computed, defineComponent, onMounted, reactive, ref, watch } from 'vue'\nexport default defineComponent({\n  name: 'BVirtualList',\n  props: {\n    size: {\n      type: Number,\n      default: 35\n    },\n    remain: {\n      type: Number,\n      default: 8\n    },\n    items: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(props, { slots }) {\n    const bem = createNamespace('vl')\n    const wrapperRef = ref<HTMLElement>()\n    const barRef = ref<HTMLElement>()\n    const state = reactive({\n      start: 0,\n      end: props.remain\n    })\n    const prev = computed(() => {\n      return Math.min(state.start, props.remain)\n    })\n    const next = computed(() => {\n      return Math.min(props.remain, props.items.length - state.end)\n    })\n    const visibleData = computed(() => {\n      return props.items.slice(state.start - prev.value, state.end + next.value)\n    })\n    const offset = ref(0)\n    const handleScroll = () => {\n      // 算出来 当前滚过去⼏个了，当前从第⼏个显示\n      let scrollTop = wrapperRef.value!.scrollTop\n      state.start = Math.floor(scrollTop / props.size)\n      state.end = state.start + props.remain\n      offset.value = state.start * props.size - props.size * prev.value // 让可视区域调整\n    }\n    watch(\n      () => props.items,\n      () => {\n        wrapperRef.value!.style.height = props.remain * props.size + 'px'\n        barRef.value!.style.height = props.items.length * props.size + 'px'\n      }\n    )\n    onMounted(() => {\n      wrapperRef.value!.style.height = props.remain * props.size + 'px'\n      barRef.value!.style.height = props.items.length * props.size + 'px'\n    })\n    return () => {\n      return (\n        <div class={bem.b()} ref={wrapperRef} onScroll={handleScroll}>\n          <div class={bem.e('scroll-bar')} ref={barRef}></div>\n          <div\n            class={bem.e('scroll-list')}\n            style={{\n              transform: `translate3d(0,${offset.value}px,0)`\n            }}\n          >\n            {visibleData.value.map((node, idx) => slots.default!({ node }))}\n          </div>\n        </div>\n      )\n    }\n  }\n})\n"],"names":["defineComponent","createNamespace","ref","reactive","computed","watch","onMounted","_createVNode"],"mappings":";;;;AAGA,MAAe,WAAgBA,oCAAgB;AAAA,EAC7C,MAAM;AAAA,EACN,OAAO;AAAA,IACL,MAAM;AAAA,MACJ,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,IACD,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,IACD,OAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS,MAAM,CAAE;AAAA,IAClB;AAAA,EACF;AAAA,EACD,MAAM,OAAO;AAAA,IACX;AAAA,EACJ,GAAK;AACD,UAAM,MAAMC,sBAAgB,IAAI;AAChC,UAAM,aAAaC,IAAAA;AACnB,UAAM,SAASA,IAAAA;AACf,UAAM,QAAQC,IAAAA,SAAS;AAAA,MACrB,OAAO;AAAA,MACP,KAAK,MAAM;AAAA,IACjB,CAAK;AACD,UAAM,OAAOC,IAAAA,SAAS,MAAM;AAC1B,aAAO,KAAK,IAAI,MAAM,OAAO,MAAM,MAAM;AAAA,IAC/C,CAAK;AACD,UAAM,OAAOA,IAAAA,SAAS,MAAM;AAC1B,aAAO,KAAK,IAAI,MAAM,QAAQ,MAAM,MAAM,SAAS,MAAM,GAAG;AAAA,IAClE,CAAK;AACD,UAAM,cAAcA,IAAAA,SAAS,MAAM;AACjC,aAAO,MAAM,MAAM,MAAM,MAAM,QAAQ,KAAK,OAAO,MAAM,MAAM,KAAK,KAAK;AAAA,IAC/E,CAAK;AACD,UAAM,SAASF,QAAI,CAAC;AACpB,UAAM,eAAe,MAAM;AAEzB,UAAI,YAAY,WAAW,MAAM;AACjC,YAAM,QAAQ,KAAK,MAAM,YAAY,MAAM,IAAI;AAC/C,YAAM,MAAM,MAAM,QAAQ,MAAM;AAChC,aAAO,QAAQ,MAAM,QAAQ,MAAM,OAAO,MAAM,OAAO,KAAK;AAAA,IAClE;AAEIG,cAAM,MAAM,MAAM,OAAO,MAAM;AAC7B,iBAAW,MAAM,MAAM,SAAS,MAAM,SAAS,MAAM,OAAO;AAC5D,aAAO,MAAM,MAAM,SAAS,MAAM,MAAM,SAAS,MAAM,OAAO;AAAA,IACpE,CAAK;AACDC,QAAAA,UAAU,MAAM;AACd,iBAAW,MAAM,MAAM,SAAS,MAAM,SAAS,MAAM,OAAO;AAC5D,aAAO,MAAM,MAAM,SAAS,MAAM,MAAM,SAAS,MAAM,OAAO;AAAA,IACpE,CAAK;AACD,WAAO,MAAM;AACX,aAAOC,IAAAA,YAAa,OAAO;AAAA,QACzB,SAAS,IAAI,EAAG;AAAA,QAChB,OAAO;AAAA,QACP,YAAY;AAAA,MACpB,GAAS,CAACA,IAAY,YAAC,OAAO;AAAA,QACtB,SAAS,IAAI,EAAE,YAAY;AAAA,QAC3B,OAAO;AAAA,MACf,GAAS,IAAI,GAAGA,IAAY,YAAC,OAAO;AAAA,QAC5B,SAAS,IAAI,EAAE,aAAa;AAAA,QAC5B,SAAS;AAAA,UACP,WAAW,iBAAiB,OAAO;AAAA,QACpC;AAAA,MACT,GAAS,CAAC,YAAY,MAAM,IAAI,CAAC,MAAM,QAAQ,MAAM,QAAQ;AAAA,QACrD;AAAA,MACR,CAAO,CAAC,CAAC,CAAC,CAAC,CAAC;AAAA,IACZ;AAAA,EACG;AACH,CAAC;;"}